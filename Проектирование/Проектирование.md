# Выбор средств проектирования
Для реализации распознавания лиц будет применяться нейроесть, так как эта задача требует обработки большого объема данных. Нейросети, благодаря своей структуре, способны обучаться на больших объемах данных, а также выявлять закономерности, которые позволят реализовать алгоритм распознавания.

Нейросеть будет написана на языке Python, так как именно для этого языка написаны популярные библиотеки для машинного обучения. Также Python лучше работает с большими объёмами данных.

В проекте будут использоваться такие технологии, как:
* **_MTCNN_** для нахождения лиц;
* **_FaceNet_** для распознавания лиц;
* **_Tensorflow_** для реализации машинного обучения;
* **_OpenCV_** для работы с изображениями.

# Проектирование архитектуры
Для решения задачи распознавания лиц (или классификации изображения) будет применяться свёрточная нейронная сеть. Работает она следующим образом: берётся изображение, пропускается через серию свёрточных, нелинейных слоев, слоев объединения и полносвязных слоёв, и генерируется вывод.

![СНН](https://camo.githubusercontent.com/180230d086c7be66d61881249e737aeec562a494e74a0d458965b3d5c1f0d9f9/68747470733a2f2f686162726173746f726167652e6f72672f776562742f74662f70622f396d2f74667062396d64613577686278717861756374345f64686e6b71772e706e67)
Выводом может быть класс или вероятность классов, которые лучше всего описывают изображение (в нашем случае, степень сходства сканированного лица с лицом в БД).

Структура сети — однонаправленная (т.е. без обратных связей), многослойная. 
![Структура](http://images.myshared.ru/27/1296020/slide_3.jpg)

Для обучения будет использоваться метод обратного распространения ошибки. ![Метод](https://present5.com/presentation/c28a7f2ea63722d326cc86e67ad0d894/image-13.jpg)

Функции активации нейронов (она же передаточная функция):  для выходного слоя - softmax. ![softmax](https://i.ytimg.com/vi/lvNdl7yg4Pg/maxresdefault.jpg)

Для скрытых слоёв - ReLU.

![relu](https://github.com/Ambaccador-Gre4ki/Visual_Recognition_System/blob/28b3d3dff79e2d60cf510f0b140c79e8750ec937/docs/relu.png)

# Проектирование БД
Как таковой, базы данных нет. Однако в отдельном каталоге _detection_ будут храниться фото- и видеофайлы.

В каталоге _detection_image_ будут храниться фотографии в формате JPG. В подкаталоге _input_ будет находиться фото, в котром необходимо распознать все лица. Наденные лица будут размещены в подкаталоге _output_. В этом подкаталоге будут ещё две директории: в _selected_ попадут лица, в которых система уверенна, а в _rejected_ попадут смазанные лица и прочие объекты, которые не получилось распознать.

В каталоге _detection_video_ будут находиться видеофайлы в формате MP4. В каталоге будут подкаталоги с такими же названиями и с такой же логикой. 

Фотографии людей, с которым скан будет сравниваться (грубо говоря, "эталонные лица") будут храниться в каталоге _people_.

Графически структура изображена ниже:

![Картинка БД](https://github.com/Ambaccador-Gre4ki/Visual_Recognition_System/blob/400b4a092c8634f9da6c9ea9ea27c4498b1dca08/docs/diagram.png)
